(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{"8a72":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-page",{staticClass:"bg-grey-3"},[i("div",{staticClass:"q-pa-md"},[i("q-expansion-item",{attrs:{"expand-separator":"",icon:"info","default-opened":"","header-class":"bg-blue text-h6",dark:"",label:"Информация о лекарстве "+t.getMedicines.title}},[i("q-list",{staticClass:"bg-white shadow-1",attrs:{bordered:"",separator:"",dense:""}},[i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[i("q-item-section",[i("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Название лекарства : "),i("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.title))])])],1)],1),i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[i("q-item-section",[i("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Описание: "),i("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.description))])])],1)],1),i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[i("q-item-section",[i("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Штрих-код: "),i("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.barcode))])])],1)],1),i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[i("q-item-section",[i("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Страна: "),i("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.country))])])],1)],1),i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[i("q-item-section",[i("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Производитель: "),i("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.manufacture))])])],1)],1),i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[i("q-item-section",[i("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Серийный номер: "),i("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.serial_code))])])],1)],1),i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[i("q-item-section",[i("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("НДС: "),i("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.vat)+"%")])])],1)],1),i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[i("q-item-section",[i("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Общее количество в бизнесе: "),i("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.total_quantity))])])],1)],1),i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[i("q-item-section",[i("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Оставшееся количество в бизнесе: "),i("span",{staticClass:"text-subtitle1 text-black"},[t._v(t._s(t.getMedicines.left_quantity))])])],1)],1)],1)],1),i("div",{staticClass:"q-mt-md"},[i("q-btn",{staticClass:"q-mb-xs q-mr-xs",attrs:{push:"",color:"white","text-color":"blue",icon:"fas fa-arrow-left",to:"/medicines"}}),i("q-btn",{staticClass:"q-mb-xs",attrs:{push:"",color:"white","text-color":"primary",label:"Добавить",disable:t.loading,to:{name:"add-info-medicine",params:{id:t.id}}}})],1),i("div",{staticClass:"q-mt-xs"},[i("q-table",{attrs:{dense:"",data:t.data,columns:t.columns,"row-key":"index",filter:t.filter,loading:t.loading,separator:"cell",pagination:t.pagination,"rows-per-page-options":[0],"pagination-label":function(e,i,a){return e+"-"+i+" из "+t.rowsNumber}},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"body-cell-actions",fn:function(e){return[i("q-td",{attrs:{props:e}},[i("q-btn",{attrs:{dense:"",round:"",flat:"",color:"grey",icon:"add_circle"},on:{click:function(i){(t.addRow=!t.addRow)&&(t.temp=e.row)}}}),i("q-btn",{attrs:{dense:"",round:"",flat:"",color:"grey",icon:"edit"}}),i("q-btn",{attrs:{dense:"",round:"",flat:"",color:"grey",icon:"fas fa-info-circle"}})],1)]}},{key:"top",fn:function(e){return[i("span",{staticClass:"text-h6"},[t._v("Товары с разной наценкой")]),i("q-space"),i("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"fas fa-sync-alt",color:t.rColor,size:"sm"},on:{click:t.refresh}}),i("q-btn",{staticClass:"q-ml-sm",attrs:{flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:e.toggleFullscreen}})]}}])})],1),i("div",{staticClass:"q-mt-md"},[i("q-table",{attrs:{dense:"",data:t.data2,columns:t.columns2,"row-key":"index",filter:t.filter,loading:t.loading2,separator:"cell",pagination:t.pagination2,"rows-per-page-options":[0],"pagination-label":function(t,e,i){return t+"-"+e+" из "+i}},on:{"update:pagination":function(e){t.pagination2=e}},scopedSlots:t._u([{key:"body-cell-actions",fn:function(t){return[i("q-td",{attrs:{props:t}},[i("q-btn",{attrs:{dense:"",round:"",flat:"",color:"grey",icon:"edit"}}),i("q-btn",{attrs:{dense:"",round:"",flat:"",color:"grey",icon:"fas fa-info-circle"}})],1)]}},{key:"top",fn:function(e){return[i("span",{staticClass:"text-h6"},[t._v("Лекарства в филиалах")]),i("q-space"),i("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"fas fa-sync-alt",color:t.rColor2,size:"sm"},on:{click:t.refresh2}}),i("q-btn",{staticClass:"q-ml-sm",attrs:{flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:e.toggleFullscreen}})]}}])})],1)],1),i("q-dialog",{attrs:{persistent:""},model:{value:t.addRow,callback:function(e){t.addRow=e},expression:"addRow"}},[i("q-card",{staticStyle:{"min-width":"50vw"}},[i("q-card-section",{staticClass:"bg-info"},[i("div",{staticClass:"text-h6 text-white"},[t._v("Добавить в корзину")])]),i("q-separator"),i("q-form",{staticClass:"q-pt-md",on:{submit:t.addToCart,reset:t.onReset}},[i("q-card-section",{staticClass:"q-pt-none"},[i("div",{staticClass:"row"},[i("q-select",{staticClass:"q-my-md col-12",attrs:{outlined:"",options:t.distribution_options,label:"Филиал"},model:{value:t.distribution_branch,callback:function(e){t.distribution_branch=e},expression:"distribution_branch"}})],1),i("div",{staticClass:"row q-mb-xs content-stretch"},[i("q-input",{staticClass:"col",attrs:{outlined:"",label:"Кол-во упаковок",suffix:String(t.left_quantity_box),rules:[function(e){return e>=0&&e<=t.left_quantity_box||"В складе имеется "+t.left_quantity_box+" упаковок"}]},model:{value:t.distribution_amount.box,callback:function(e){t.$set(t.distribution_amount,"box",e)},expression:"distribution_amount.box"}}),t.temp.capacity>1?i("q-input",{staticClass:"q-pl-md col",attrs:{outlined:"",label:"Кол-во штук",suffix:String(t.left_quantity_piece),rules:[function(e){return e>=0&&e<=t.left_quantity_piece||"В складе имеется "+t.left_quantity_piece+" штук"}]},model:{value:t.distribution_amount.piece,callback:function(e){t.$set(t.distribution_amount,"piece",e)},expression:"distribution_amount.piece"}}):t._e()],1)]),i("q-card-actions",{staticClass:"bg-white text-white",attrs:{align:"right"}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"bg-info",attrs:{label:"Отменить",type:"reset"}}),i("q-btn",{staticClass:"bg-info",attrs:{label:"Добавить",type:"submit",disable:""==t.distribution_branch}})],1)],1)],1)],1)],1)},n=[],s=(i("8e6e"),i("8a81"),i("ac6a"),i("cadf"),i("06db"),i("456d"),i("7f7f"),i("c47a")),r=i.n(s),l=(i("f751"),i("c5f6"),i("967e")),o=i.n(l),c=(i("96cf"),i("fa84")),u=i.n(c),d=i("2f62");function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function b(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){r()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var f={props:{id:{required:!0}},data:function(){return{rColor:"grey",rColor2:"grey",rowsNumber:null,temp:{},left_quantity_box:null,left_quantity_piece:null,addRow:!1,distribution_amount:{box:"",piece:""},distribution_branch:"",distribution_options:[],getMedicines:{title:"",barcode:"",country:"",manufacture:"",serial_code:"",vat:"",total_quantity:"",left_quantity:""},pagination:{rowsPerPage:8,page:1},pagination2:{rowsPerPage:8},loading:!1,loading2:!1,filter:"",columns:[{name:"index",align:"center",label:"№",field:"index",sortable:!0},{name:"expire_date",align:"center",label:"Годен до",field:"expire_date",sortable:!0},{name:"total_quantity",align:"center",label:"Общее кол-во",field:"total_quantity",sortable:!0},{name:"left_quantity",align:"center",label:"Остаток",field:"left_quantity",sortable:!0},{name:"purchase_price",align:"center",label:"Цена покупки",field:"purchase_price",sortable:!0},{name:"selling_price",align:"center",label:"Цена продажи",field:"selling_price",sortable:!0},{name:"actions",label:"Действия",field:"",align:"center"}],columns2:[{name:"index",align:"center",label:"№",field:"index",sortable:!0},{name:"name",align:"center",label:"Имя",field:"name",sortable:!0},{name:"address",align:"center",label:"Адрес",field:"address",sortable:!0},{name:"city",align:"center",label:"Город",field:"city",sortable:!0},{name:"contact_person",align:"center",label:"Контактное лицо",field:"contact_person",sortable:!0},{name:"contact_phone",align:"center",label:"Контактный телефон",field:"contact_phone",sortable:!0},{name:"status",align:"center",label:"Статус",field:"status",sortable:!0},{name:"street",align:"center",label:"Улица",field:"street",sortable:!0},{name:"total_quantity",align:"center",label:"Кол-во",field:"total_quantity",sortable:!0},{name:"actions",label:"Действия",field:"",align:"center"}],data:[],data2:[]}},watch:{"pagination.page":function(){var t=u()(o.a.mark((function t(e,i){return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e!=this.pagesNumber){t.next=3;break}return t.next=3,this.GET_NEXT_PAGE_FOR_MEDICINE_INFO();case 3:case"end":return t.stop()}}),t,this)})));function e(e,i){return t.apply(this,arguments)}return e}(),"distribution_amount.box":function(t,e){t<this.left_quantity_box?this.left_quantity_piece=Number(this.temp.capacity):t==this.left_quantity_box&&(this.left_quantity_piece=Number(this.temp.left_quantity_piece))},"temp.left_quantity_box":function(t,e){this.left_quantity_box=Number(this.temp.left_quantity_box)},"temp.left_quantity_piece":function(t,e){this.left_quantity_piece=Number(this.temp.left_quantity_piece)},addRow:function(t,e){1==t&&this.temp.capacity<=1&&Object.assign(this.distribution_amount,{piece:0})}},mounted:function(){var t=this;return u()(o.a.mark((function e(){var i;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.GET_MEDICINE_DETAIL({id:t.id});case 2:return i=e.sent,Object.assign(t.getMedicines,{title:i.title,description:i.description,barcode:i.barcode,country:i.country,manufacture:i.manufacture,serial_code:i.serial_code,vat:i.vat,total_quantity:i.total_quantity,left_quantity:i.left_quantity}),e.next=6,t.refresh();case 6:return e.next=8,t.refresh2();case 8:return e.next=10,t.GET_BRANCHES();case 10:return e.next=12,t.getBranchNames;case 12:t.distribution_options=e.sent;case 13:case"end":return e.stop()}}),e)})))()},computed:b(b({},Object(d["c"])(["getBranches","getMedicinesInfo","getBranchesInMedInfoPage"])),{},{getBranchNames:function(){for(var t=[],e=0;e<this.getBranches.length;e++)t.push(this.getBranches[e].name);return t},pagesNumber:function(){return Math.ceil(this.data.length/this.pagination.rowsPerPage)}}),methods:b(b({},Object(d["b"])(["GET_MEDICINE_DETAIL","GET_MEDICINE_INFO","GET_BRANCHES","GET_BRANCHES_IN_MED_INFO_PAGE","ADD_TO_CART","GET_NEXT_PAGE_FOR_MEDICINE_INFO"])),{},{refresh:function(){var t=this;return u()(o.a.mark((function e(){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.rColor="blue",t.loading=!0,e.next=4,t.GET_MEDICINE_INFO({id:t.id});case 4:return e.next=6,t.getMedicinesInfo.count;case 6:return t.rowsNumber=e.sent,e.next=9,t.getMedicinesInfo.results;case 9:t.data=e.sent,t.pagination.page=1,t.loading=!1,t.rColor="grey";case 13:case"end":return e.stop()}}),e)})))()},refresh2:function(){var t=this;return u()(o.a.mark((function e(){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.rColor2="blue",t.loading2=!0,e.next=4,t.GET_BRANCHES_IN_MED_INFO_PAGE({id:t.id});case 4:return e.next=6,t.getBranchesInMedInfoPage;case 6:t.data2=e.sent,t.loading2=!1,t.rColor2="grey";case 9:case"end":return e.stop()}}),e)})))()},addToCart:function(){var t=this;return u()(o.a.mark((function e(){var i;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$emit("medicines",!0);case 2:return i=t.getBranches.filter((function(e){return e.name==t.distribution_branch})),""==t.distribution_amount.piece&&(t.distribution_amount.piece=0),""==t.distribution_amount.box&&(t.distribution_amount.box=0),e.next=7,t.ADD_TO_CART({business_medicine_info_id:t.temp.business_medicine_info_id,quantity_box:t.distribution_amount.box,quantity_piece:t.distribution_amount.piece,branch_id:i[0].id});case 7:return t.$q.notify({icon:"done",color:"positive",message:"Успешно отправлено в корзину!"}),t.addRow=!1,e.next=11,t.onReset();case 11:return e.next=13,t.refresh();case 13:case"end":return e.stop()}}),e)})))()},onReset:function(){this.distribution_branch="",this.distribution_amount={box:"",piece:""}}})},_=f,m=i("2877"),g=Object(m["a"])(_,a,n,!1,null,"7dc2db39",null);e["default"]=g.exports}}]);