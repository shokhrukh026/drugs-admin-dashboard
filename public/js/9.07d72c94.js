(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"0329":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"bg-grey-3"},[a("div",{staticClass:"q-pa-md"},[a("q-expansion-item",{attrs:{"expand-separator":"",icon:"info","default-opened":"","header-class":"bg-blue text-h6",dark:"",label:"Информация о лекарстве "+t.getMedicines.title}},[a("q-list",{staticClass:"bg-white shadow-1",attrs:{bordered:"",separator:"",dense:""}},[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[a("q-item-section",[a("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Название лекарства : "),a("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.title))])])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[a("q-item-section",[a("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Описание: "),a("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.description))])])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[a("q-item-section",[a("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Штрих-код: "),a("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.barcode))])])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[a("q-item-section",[a("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Страна: "),a("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.country))])])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[a("q-item-section",[a("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Производитель: "),a("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.manufacture))])])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[a("q-item-section",[a("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Серийный номер: "),a("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.serial_code))])])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[a("q-item-section",[a("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("НДС: "),a("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.vat)+"%")])])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}]},[a("q-item-section",[a("q-item-label",{staticClass:"text-h6 text-blue-9"},[t._v("Общее количество в филиале: "),a("span",{staticClass:"text-subtitle1 text-black"},[t._v(" "+t._s(t.getMedicines.total_quantity))])])],1)],1)],1)],1),a("q-btn",{staticClass:"q-mt-md q-mr-xs",attrs:{push:"",color:"white","text-color":"blue",icon:"fas fa-arrow-left",to:{name:"branch-info",params:{id:t.branch_id}}}}),a("div",{staticClass:"q-mt-xs"},[a("q-table",{attrs:{dense:"",data:t.data,columns:t.columns,"row-key":"index",filter:t.filter,loading:t.loading,separator:"cell",pagination:t.pagination,"rows-per-page-options":[0],"pagination-label":function(e,a,i){return e+"-"+a+" из "+t.rowsNumber}},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"body-cell-actions",fn:function(e){return[a("q-td",{attrs:{props:e}},[a("q-btn",{attrs:{dense:"",round:"",flat:"",color:"grey",icon:"remove_circle"},on:{click:function(a){(t.addRow=!t.addRow)&&(t.temp=e.row)}}}),a("q-btn",{attrs:{dense:"",round:"",flat:"",color:"grey",icon:"edit"}}),a("q-btn",{attrs:{dense:"",round:"",flat:"",color:"grey",icon:"fas fa-info-circle"}})],1)]}},{key:"top",fn:function(e){return[a("span",{staticClass:"text-h6"},[t._v("Товары с разной наценкой")]),a("q-space"),a("q-btn",{staticClass:"q-ml-md",attrs:{flat:"",round:"",dense:"",icon:"fas fa-sync-alt",color:t.rColor,size:"sm"},on:{click:t.refresh}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:e.toggleFullscreen}})]}}])})],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.addRow,callback:function(e){t.addRow=e},expression:"addRow"}},[a("q-card",[a("q-card-section",{staticClass:"bg-info"},[a("div",{staticClass:"text-h6 text-white"},[t._v("Возврат")])]),a("q-separator"),a("q-card-section",{staticClass:"q-pt-none q-pa-lg"},[a("div",{staticClass:"row"},[a("q-input",{staticClass:"q-mr-xs col",attrs:{outlined:"",label:"Кол-во упаковок",suffix:String(t.temp_total_quantity),rules:[function(e){return e>=0&&e<=t.temp_total_quantity||"В складе имеется "+t.temp_total_quantity+" упаковок"}]},model:{value:t.distribution_amount.box,callback:function(e){t.$set(t.distribution_amount,"box",e)},expression:"distribution_amount.box"}}),a("q-input",{staticClass:"col",attrs:{outlined:"",label:"Кол-во штук",suffix:String(t.temp_total_piece),rules:[function(e){return e>=0&&e<=t.temp_total_piece||"В складе имеется "+t.temp_total_piece+" штук"}]},model:{value:t.distribution_amount.piece,callback:function(e){t.$set(t.distribution_amount,"piece",e)},expression:"distribution_amount.piece"}})],1),a("div",{staticClass:"q-mt-md"},[a("span",{staticClass:"text-green text-weight-bold"},[t._v("Уже добавлено:")]),t._v(" "+t._s(t.temp_already_added))])]),a("q-separator"),a("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отменить"}}),a("q-btn",{attrs:{flat:"",label:"Добавить"},on:{click:t.addRefunds}})],1)],1)],1)],1)},n=[],s=(a("8e6e"),a("8a81"),a("ac6a"),a("cadf"),a("06db"),a("456d"),a("c47a")),r=a.n(s),c=(a("f751"),a("c5f6"),a("967e")),l=a.n(c),o=(a("96cf"),a("fa84")),d=a.n(o),u=a("2f62");function p(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function _(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?p(Object(a),!0).forEach((function(e){r()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var b={props:{business_medicine_id:{required:!0},branch_id:{required:!0}},data:function(){return{rColor:"grey",id:"",rowsNumber:null,temp:{},temp_total_quantity:"",temp_total_piece:"",temp_already_added:"",addRow:!1,distribution_amount:{box:"",piece:""},getMedicines:{title:"",barcode:"",country:"",manufacture:"",serial_code:"",vat:"",total_quantity:"",left_quantity:""},pagination:{rowsPerPage:8,page:1},loading:!1,filter:"",columns:[{name:"index",align:"center",label:"№",field:"index",sortable:!0},{name:"expire_date",align:"center",label:"Годен до",field:"expire_date",sortable:!0},{name:"quantity",align:"center",label:"Кол-во",field:"quantity",sortable:!0},{name:"purchase_price",align:"center",label:"Цена покупки",field:"purchase_price",sortable:!0},{name:"selling_price",align:"center",label:"Цена продажи",field:"selling_price",sortable:!0},{name:"actions",label:"Действия",field:"",align:"center"}],data:[]}},watch:{"pagination.page":function(){var t=d()(l.a.mark((function t(e,a){return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e!=this.pagesNumber){t.next=3;break}return t.next=3,this.GET_NEXT_PAGE_FOR_BRANCH_INFO_DETAIL();case 3:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),"temp.total_qauntity":function(t,e){this.temp_total_quantity=Number(this.temp.total_qauntity)},addRow:function(){var t=d()(l.a.mark((function t(e,a){var i;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!=e){t.next=7;break}return t.next=3,this.GET_CHECK_FOR_REFUND({branch_id:this.branch_id,med_info_id:this.temp.business_medicine_info_id});case 3:i=t.sent,this.temp_total_quantity=Math.floor(i.limit_quantity/i.capacity),this.temp_total_piece=i.limit_quantity%i.capacity,0!=i.already_added?this.temp_already_added=Math.floor(i.already_added/i.capacity)+" упаковок (по "+i.capacity+" ) и "+i.already_added%i.capacity+" штук":this.temp_already_added=0;case 7:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}()},mounted:function(){var t=this;return d()(l.a.mark((function e(){var a;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.GET_BRANCH_MEDICINE_DETAIL({branch_id:t.branch_id,business_medicine_id:t.business_medicine_id});case 2:return a=e.sent,Object.assign(t.getMedicines,{title:a.title,description:a.description,barcode:a.barcode,country:a.country,manufacture:a.manufacture,serial_code:a.serial_code,vat:a.vat,total_quantity:a.total_quantity}),e.next=6,t.refresh();case 6:case"end":return e.stop()}}),e)})))()},computed:_(_({},Object(u["c"])(["getBranchMedicineInfo","getBranchMedicineDetail"])),{},{pagesNumber:function(){return Math.ceil(this.data.length/this.pagination.rowsPerPage)}}),methods:_(_({},Object(u["b"])(["GET_BRANCH_MEDICINE_DETAIL","GET_BRANCH_MEDICINE_INFO","GET_CHECK_FOR_REFUND","ADD_REFUND","GET_NEXT_PAGE_FOR_BRANCH_INFO_DETAIL"])),{},{refresh:function(){var t=this;return d()(l.a.mark((function e(){return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.rColor="blue",t.loading=!0,e.next=4,t.GET_BRANCH_MEDICINE_INFO({branch_id:t.branch_id,business_medicine_id:t.business_medicine_id});case 4:return e.next=6,t.getBranchMedicineInfo.count;case 6:return t.rowsNumber=e.sent,e.next=9,t.getBranchMedicineInfo.results;case 9:t.data=e.sent,t.pagination.page=1,t.loading=!1,t.rColor="grey";case 13:case"end":return e.stop()}}),e)})))()},addRefunds:function(){var t=this;return d()(l.a.mark((function e(){var a;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return""==t.distribution_amount.box&&(t.distribution_amount.box=0),""==t.distribution_amount.piece&&(t.distribution_amount.piece=0),e.next=4,t.ADD_REFUND({branch_id:t.branch_id,business_medicine_info_id:t.temp.business_medicine_info_id,quantity_box:t.distribution_amount.box,quantity_piece:t.distribution_amount.piece});case 4:a=e.sent,Object.assign(t.distribution_amount,{box:"",piece:""}),"SUCCESS"==a.status?t.$q.notify({message:"Успешно добавлено!",color:"green"}):t.$q.notify({message:"Ошибка!",color:"negative"}),t.addRow=!1;case 8:case"end":return e.stop()}}),e)})))()}})},m=b,f=a("2877"),h=Object(f["a"])(m,i,n,!1,null,"0e4b522a",null);e["default"]=h.exports}}]);